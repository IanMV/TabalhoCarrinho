import{_ as b,a as x}from"./loginregister-DQ4joawM.js";import{d as f,U as _,w as h,v as k,u as o,c as p,o as n,a as S,e as U,M as v,r as N,b as T,f as r,g as l,h as u,i as V,t as d,j as $,k as O,l as j,m as B}from"./index-BG4DwY_0.js";const L=f({__name:"NameCamp",setup(m){const s=_();return(e,t)=>h((n(),p("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).name=a),placeholder:"Nome..."},null,512)),[[k,o(s).name]])}});var g={};U.config();const w=S("Code",()=>{const m=_(),s=v(),e=N();async function t(){try{switch((await fetch(`${g.LOCAL}/user/check-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.value,email:m.email})})).status){case 200:s.steps.three=!0;break;case 400:s.message="*Código inválido";break;default:s.message="*Um erro ocorreu"}}catch(i){console.error(i),s.message="*Um erro ocorreu"}}async function a(){try{switch((await fetch(`${g.LOCAL}/email/send-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m.email})})).status){case 418:s.message="*Email ja cadastrado";break;case 200:s.steps.two=!0;break;case 409:s.steps.two=!0,s.message="*Código ja enviado à este email";break;default:s.message="*Um erro ocorreu";break}}catch(i){console.error(i),s.message="*Um erro ocorreu"}}return{code:e,verification:t,sendtoken:a}}),R=f({__name:"TokenCamp",setup(m){const s=w();return(e,t)=>h((n(),p("input",{type:"number",maxlength:"6",oninput:"this.value=this.value.slice(0,6)","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).code=a)},null,512)),[[k,o(s).code]])}}),A={id:"main"},E={id:"usercamps"},J={key:4},M={id:"buttondiv"},q=f({__name:"RegisterPage",setup(m){const s=j(),e=v(),t=_(),a=w();async function i(){if(e.steps.two)if(e.steps.two&&!e.steps.three){e.message="",await a.verification();return}else e.steps.three&&(e.message="",await t.register());else if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)){e.message="",await a.sendtoken();return}else{e.message="*Invalid email";return}}function y(){e.steps.two?e.steps.two?(e.message="",a.code=void 0,e.steps.two=!1):e.steps.three&&(e.message="",t.name="",t.password="",a.code=void 0,e.steps.two=!1,e.steps.three=!1):s.push("/")}return T(()=>{t.password="",t.email="",t.name="",a.code=void 0,e.message=""}),(P,c)=>{const C=O("router-link");return n(),p("main",A,[c[2]||(c[2]=r("aside",null,[r("h1",null,"Bem-vindo!")],-1)),r("section",null,[r("form",null,[c[1]||(c[1]=r("h2",null,"Register",-1)),r("div",E,[o(e).steps.two&&!o(e).steps.three?(n(),l(R,{key:0})):u("",!0),o(e).steps.three?(n(),l(L,{key:1})):u("",!0),o(e).steps.two?u("",!0):(n(),l(b,{key:2})),o(e).steps.three?(n(),l(x,{key:3})):u("",!0),o(e).message!=""?(n(),p("p",J,d(o(e).message),1)):u("",!0),V(C,{to:"/login"},{default:$(()=>c[0]||(c[0]=[B("Já tem uma conta?")])),_:1})]),r("div",M,[r("button",{type:"button",onClick:y},d(o(e).steps.two||o(e).steps.three?"Voltar":"Cancelar"),1),r("button",{type:"button",onClick:i},d(o(e).steps.three?"Registrar":"Avançar"),1)])])])])}}});export{q as default};
