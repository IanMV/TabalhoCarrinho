import{_ as C,a as x}from"./loginregister-Dz1C3ABa.js";import{d as f,U as _,w as h,v as k,u as o,c as p,o as n,a as S,M as w,r as U,b as N,e as r,f as l,g as m,h as T,t as d,i as V,j as $,k as j,l as B}from"./index-CSVQ92aH.js";const O=f({__name:"NameCamp",setup(u){const s=_();return(e,t)=>h((n(),p("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).name=a),placeholder:"Nome..."},null,512)),[[k,o(s).name]])}}),g=void 0,y=S("Code",()=>{const u=_(),s=w(),e=U();async function t(){try{switch((await fetch(`${g}/user/check-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.value,email:u.email})})).status){case 200:s.steps.three=!0;break;case 400:s.message="*Código inválido";break;default:s.message="*Um erro ocorreu"}}catch(i){console.error(i),s.message="*Um erro ocorreu"}}async function a(){try{switch((await fetch(`${g}/email/send-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u.email})})).status){case 418:s.message="*Email ja cadastrado";break;case 200:s.steps.two=!0;break;case 409:s.steps.two=!0,s.message="*Código ja enviado à este email";break;default:s.message="*Um erro ocorreu";break}}catch(i){console.error(i),s.message="*Um erro ocorreu"}}return{code:e,verification:t,sendtoken:a}}),R=f({__name:"TokenCamp",setup(u){const s=y();return(e,t)=>h((n(),p("input",{type:"number",maxlength:"6",oninput:"this.value=this.value.slice(0,6)","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).code=a)},null,512)),[[k,o(s).code]])}}),E={id:"main"},J={id:"usercamps"},M={key:4},P={id:"buttondiv"},q=f({__name:"RegisterPage",setup(u){const s=j(),e=w(),t=_(),a=y();async function i(){if(e.steps.two)if(e.steps.two&&!e.steps.three){e.message="",await a.verification();return}else e.steps.three&&(e.message="",await t.register());else if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)){e.message="",await a.sendtoken();return}else{e.message="*Invalid email";return}}function v(){e.steps.two?e.steps.two?(e.message="",a.code=void 0,e.steps.two=!1):e.steps.three&&(e.message="",t.name="",t.password="",a.code=void 0,e.steps.two=!1,e.steps.three=!1):s.push("/")}return N(()=>{t.password="",t.email="",t.name="",a.code=void 0,e.message=""}),(D,c)=>{const b=$("router-link");return n(),p("main",E,[c[2]||(c[2]=r("aside",null,[r("h1",null,"Bem-vindo!")],-1)),r("section",null,[r("form",null,[c[1]||(c[1]=r("h2",null,"Register",-1)),r("div",J,[o(e).steps.two&&!o(e).steps.three?(n(),l(R,{key:0})):m("",!0),o(e).steps.three?(n(),l(O,{key:1})):m("",!0),o(e).steps.two?m("",!0):(n(),l(C,{key:2})),o(e).steps.three?(n(),l(x,{key:3})):m("",!0),o(e).message!=""?(n(),p("p",M,d(o(e).message),1)):m("",!0),T(b,{to:"/login"},{default:V(()=>c[0]||(c[0]=[B("Já tem uma conta?")])),_:1})]),r("div",P,[r("button",{type:"button",onClick:v},d(o(e).steps.two||o(e).steps.three?"Voltar":"Cancelar"),1),r("button",{type:"button",onClick:i},d(o(e).steps.three?"Registrar":"Avançar"),1)])])])])}}});export{q as default};
