import{_ as b,a as C}from"./loginregister-DYvGL9Wk.js";import{d as f,U as h,w as _,v as g,u as o,c as p,o as n,a as x,M as k,r as S,b as U,e as r,f as u,g as m,h as N,t as d,i as T,j as V,k as j,l as B}from"./index-BcEzmPzR.js";const $=f({__name:"NameCamp",setup(l){const s=h();return(e,t)=>_((n(),p("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).name=a),placeholder:"Nome..."},null,512)),[[g,o(s).name]])}}),w=x("Code",()=>{const l=h(),s=k(),e=S();async function t(){try{switch((await fetch("http://localhost:3000/user/check-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.value,email:l.email})})).status){case 200:s.steps.three=!0;break;case 400:s.message="*Código inválido";break;default:s.message="*Um erro ocorreu"}}catch(i){console.error(i),s.message="*Um erro ocorreu"}}async function a(){try{switch((await fetch("http://localhost:3000/email/send-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.email})})).status){case 418:s.message="*Email ja cadastrado";break;case 200:s.steps.two=!0;break;case 409:s.steps.two=!0,s.message="*Código ja enviado à este email";break;default:s.message="*Um erro ocorreu";break}}catch(i){console.error(i),s.message="*Um erro ocorreu"}}return{code:e,verification:t,sendtoken:a}}),O=f({__name:"TokenCamp",setup(l){const s=w();return(e,t)=>_((n(),p("input",{type:"number",maxlength:"6",oninput:"this.value=this.value.slice(0,6)","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).code=a)},null,512)),[[g,o(s).code]])}}),R={id:"main"},E={id:"usercamps"},J={key:4},M={id:"buttondiv"},I=f({__name:"RegisterPage",setup(l){const s=j(),e=k(),t=h(),a=w();async function i(){if(e.steps.two)if(e.steps.two&&!e.steps.three){e.message="",await a.verification();return}else e.steps.three&&(e.message="",await t.register());else if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)){e.message="",await a.sendtoken();return}else{e.message="*Invalid email";return}}function y(){e.steps.two?e.steps.two?(e.message="",a.code=void 0,e.steps.two=!1):e.steps.three&&(e.message="",t.name="",t.password="",a.code=void 0,e.steps.two=!1,e.steps.three=!1):s.push("/")}return U(()=>{t.password="",t.email="",t.name="",a.code=void 0,e.message=""}),(P,c)=>{const v=V("router-link");return n(),p("main",R,[c[2]||(c[2]=r("aside",null,[r("h1",null,"Bem-vindo!")],-1)),r("section",null,[r("form",null,[c[1]||(c[1]=r("h2",null,"Register",-1)),r("div",E,[o(e).steps.two&&!o(e).steps.three?(n(),u(O,{key:0})):m("",!0),o(e).steps.three?(n(),u($,{key:1})):m("",!0),o(e).steps.two?m("",!0):(n(),u(b,{key:2})),o(e).steps.three?(n(),u(C,{key:3})):m("",!0),o(e).message!=""?(n(),p("p",J,d(o(e).message),1)):m("",!0),N(v,{to:"/login"},{default:T(()=>c[0]||(c[0]=[B("Já tem uma conta?")])),_:1})]),r("div",M,[r("button",{type:"button",onClick:y},d(o(e).steps.two||o(e).steps.three?"Voltar":"Cancelar"),1),r("button",{type:"button",onClick:i},d(o(e).steps.three?"Registrar":"Avançar"),1)])])])])}}});export{I as default};
